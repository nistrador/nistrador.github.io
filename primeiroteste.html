<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Notificação de matérias do OGlobo Digital</title>
  <link rel="manifest" href="/manifest.json">
  <script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async='async'></script>
  <script>
    var OneSignal = window.OneSignal || [];
    OneSignal.push(["init", {
      appId: "20c1f1ff-877a-446a-bf00-429920bee5ad",
      autoRegister: true, /* Set to true to automatically prompt visitors */
      notifyButton: {
          enable: false /* Set to false to hide */
      }
    }]);
  </script>

</head>
<body>
  <script>
function seNavegadorImplementaNotificacao() {
	var resultado = false;
	if ('serviceWorker' in window.navigator) {
		resultado = true;
	}
	return resultado;
}
function seLeitorNaoProibeNotificacoes() {
	var resultado = false;
	if ("Notification" in window) {
		if (Notification.permission !== "denied")
			resultado = true;
	}
	return resultado;
}

function seLeitorPermitiuNotificacaoNoSeguroOGlobo() {
	var resultado = false;
	if (window.navigator != null){
		if (navigator.serviceWorker != null && navigator.serviceWorker != 'undefined'){
			
			navigator.serviceWorker.ready.then(function(reg) {
				
				if (Notification.permission == 'granted'){
					if (reg.scope == 'https://seguro.oglobo.com.br/'){
						resultado = true;
						console.log('O domínio aqui eh:',reg.scope);
					}
				}
			});
	
		}		
	}
}
function leitorTemInscricaoNotificacao() {
	var resultado = false;
	if (window.navigator != null)
	{
		if (navigator.serviceWorker != null && navigator.serviceWorker != 'undefined')
		{ // Chega até aqui
			navigator.serviceWorker.ready.then(function(reg) {
				resultado = true;
				//if (reg.pushManager != null && reg.pushManager != 'undefined')
					//resultado = true;
			});
			//navigator.serviceWorker.getRegistrations().then(function(registrations) {
				//resultado = true;
				//if (registrations.lenght > 0)
					//resultado = true;
				//for (var i=0; i<registrations.lenght; i++)
				//{
					 //ServiceWorkerRegistration permissao = registrations[i];
				//}
			//});
		}
	}
	return resultado;
}



  </script>
  <table width="100%" height="600">
<tr><td>
<h3><p align="center">Clique para permitir a ativação do serviço de notificação de conteúdo.</p></h3>
</td></tr>
<tr>
<td>document.write(seLeitorPermitiuNotificacaoNoSeguroOGlobo());</td>
</tr>
</table>

</body>
</html>
